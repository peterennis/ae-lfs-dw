#!/bin/bash
# The proper way to start a bash script

set -e -u -x
source ~/lfs-scripts/aeSCRIPT_LIBRARY
trap simple_error ERR

echo
echo ________________________________________________________________________________
echo ${0}
DateAndTime=$(date +%Y_%m_%d_%T)
# NOTE: Use logSBU.start
echo ${DateAndTime}" "${0}" Start $(pwd)" >> ~/lfs-scripts/logSBU.start


if [[ ${#} -eq 2 ]] ; then
        echo "The command line contains $# arguments"
else
        echo $(Usage /dev/\<xxx\> 1\|2)
        exit 1
fi

echo "=> "${0}"    "${1}"    "${2}
if [[ ${2} -ne 1 ]] && [[ ${2} -ne 2 ]] ; then
        echo "=> The second parameter indicates 1 or 2 pass compiling."
        echo "=> Use 1 or 2."
        exit 1
fi

PartitionName=${1}                # fc4 adaept /dev/hdc1
                                  # fc5 www.adaept.com /dev/hdb1

echo PartitionName=${PartitionName}
echo =ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae
echo =ae{ Choose a mount point. Assign it to the LFS environment variable by running:
echo =ae{ "        "export LFS=/mnt/lfs
echo =ae{ Next, create the mount point and mount the LFS file system by running:
echo =ae{ "        "sudo mkdir -pv \${LFS}
echo =ae{ "        "sudo mount -v -t ext3 /dev/\<xxx\> \${LFS}
echo =ae{ Replace \<xxx\> with the designation of the LFS partition.
echo =ae{ If using multiple partitions for LFS \(e.g., one for \/ and another for \/usr\),
echo =ae{ mount them using:
echo =ae{ "        "sudo mkdir -pv \$LFS
echo =ae{ "        "sudo mount -v -t ext3 /dev/\<xxx\> \${LFS}
echo =ae{ "        "sudo mkdir -v \${LFS}/usr
echo =ae{ "        "sudo mount -v -t ext3 /dev/\<yyy\> \${LFS}/usr
echo =ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae
echo

echo =ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae
echo =ae{ Test if /mnt/lfs is mounted
echo =ae{ Ref: http://www.linux.com/guides/abs-guide/string-manipulation.shtml
echo =ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae=ae
echo

echo ----------8\<----------8\<----------8\<----------8\<----------8\<----------8\<----------
echo "=> "${0}" "`exec env`
export LFS=/mnt/lfs
sudo mkdir -pv ${LFS}
lfsmounted="${PartitionName} on /mnt/lfs type ext3 (rw)"
echo "=> \${lfsmounted}="${lfsmounted}
lfsmountedtest=`sudo mount`
echo "=> \${lfsmountedtest}="${lfsmountedtest}
# http://www.tldp.net/LDP/abs/html/testconstructs.html
if echo "${lfsmountedtest}" | grep -q "${lfsmounted}" ; then
	# The "-q" option to grep suppresses output.
	echo "=> \"${lfsmounted}\" found in sudo mount"
	echo "=> lfs is mounted on ${LFS}"
else
        echo "=> \"${lfsmounted}\" not found in sudo mount"
        echo "=> mounting lfs on ${LFS}"
	sudo mount -v -t ext3 ${PartitionName} ${LFS}
fi
echo ----------\>8----------\>8----------\>8----------\>8----------\>8----------\>8----------

DateAndTime=$(date +%Y_%m_%d_%T)
echo ${DateAndTime}" "${0}" End $(pwd)" >> ~/lfs-scripts/logSBU.start
echo "=>DONE "${0}
echo
